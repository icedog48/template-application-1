@using System
@using System.Collections.Generic
@using System.Linq
@using System.Text
@using System.IO
@using RazorEngine
@using RazorEngine.Templating
@using Code4U.Models
@using Code4U.Helpers

@inherits RazorEngine.Templating.Code4UTemplateBase<Project>

@{ 
    var filename = Path.Combine(Model.TemplateFolder, @"WebApi\Controllers\_Controller.cs.cshtml");
    
    foreach (var entity in Model.Entities)
    {
        var generatedCode = Include(filename, entity, typeof(Entity)).ToString();

        var generatedFileName = filename.Replace(Model.TemplateFolder + "\\", Model.Name + ".")
                                        .Replace("_Controller", entity.Name + "Controller")
                                        .Replace(".cshtml", string.Empty);

        generatedFileName = Path.Combine(Model.GeneratedCodeFolder, generatedFileName);

        FileSystemHelper.WriteFile(generatedFileName, generatedCode);
    }
}
